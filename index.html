<!DOCTYPE html>
<html>
<head>
    <title>ESP32 LED & ADC Control</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            margin-top: 50px; 
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #2c3e50;
        }
        div {
            margin: 15px 0;
            padding: 10px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: inline-block; /* To make them centered */
            min-width: 250px; /* Give them some width */
        }
        #status { 
            font-size: 24px; 
            font-weight: bold;
            color: #28a745; /* Green for ON */
        }
        #adcStatus {
            font-size: 24px;
            font-weight: bold;
            color: #007bff; /* Blue for ADC */
        }
        button { 
            padding: 12px 25px; 
            font-size: 18px; 
            cursor: pointer; 
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>
    <h1>ESP32 Control Panel</h1>
    
    <div>
        <h2>LED Control</h2>
        <div id="status">LED: OFF</div>
        <button id="toggleBtn">Toggle LED</button>
    </div>

    <br> <div>
        <h2>ADC Reading</h2>
        <div id="adcStatus">ADC Value: N/A</div>
    </div>

    <script>
        // Your Firebase project configuration
        // Replace with YOUR OWN Firebase project config if different
        const firebaseConfig = {
            apiKey: "AIzaSyCA0btNL_QIxsHryzl4ZdcfTp9pRWeI8JQ",
            authDomain: "esp32-led-control-5646a.firebaseapp.com",
            databaseURL: "https://esp32-led-control-5646a-default-rtdb.firebaseio.com",
            projectId: "esp32-led-control-5646a",
            storageBucket: "esp32-led-control-5646a.firebasestorage.app",
            messagingSenderId: "989832608239",
            appId: "1:989832608239:web:94027ebac129932ed69e1a"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Firebase references
        const ledRef = database.ref('esp32/led');
        const adcValueRef = database.ref('esp32/adc_readings/current_value'); // Reference to the ADC path

        // Get HTML elements
        const toggleBtn = document.getElementById('toggleBtn');
        const ledStatusDiv = document.getElementById('status');
        const adcStatusDiv = document.getElementById('adcStatus'); // New element for ADC

        // --- LED Control Logic ---
        toggleBtn.addEventListener('click', () => {
            ledRef.once('value').then((snapshot) => {
                const currentLedState = snapshot.val();
                ledRef.set(!currentLedState); // Toggle the state
            }).catch((error) => {
                console.error("Error toggling LED:", error);
                alert("Failed to toggle LED: " + error.message);
            });
        });

        // Listen for real-time updates to LED state
        ledRef.on('value', (snapshot) => {
            const state = snapshot.val();
            ledStatusDiv.textContent = `LED: ${state ? 'ON' : 'OFF'}`;
            ledStatusDiv.style.color = state ? '#dc3545' : '#28a745'; // Red for ON, Green for OFF
        });

        // --- ADC Reading Logic ---
        // Listen for real-time updates to ADC value
        adcValueRef.on('value', (snapshot) => {
            const adcValue = snapshot.val();
            if (adcValue !== null) {
                adcStatusDiv.textContent = `ADC Value: ${adcValue}`;
            } else {
                adcStatusDiv.textContent = `ADC Value: N/A`; // Or a default message
            }
        });

    </script>
</body>
</html>
